\ProvidesPackage{beamer_xilinx_2019}[2020/01/09 Some Xilinx 2020
specialization of the LaTeX Beamer style]

\RequirePackage{beamer_RK}

\RequirePackage{fdsymbol}% for \smallblacksquare

\mode<presentation>

\definecolor{XilinxRed}{RGB}{226,0,0}

\newcommand{\SectionBackground}{\setbeamertemplate{background canvas}{%
    % \includegraphics[width=\paperwidth,height=\paperheight]{Background/Xilinx_widescreen_size_16_9-091015-agenda_page}
    % \includegraphics[width=\paperwidth,height=\paperheight]{Background/Xilinx_widescreen_size_16_9-091015-normal_page}
    % \includegraphics[width=\paperwidth,height=\paperheight]{Background/Xilinx-Template-2018/agenda-item}
    \includegraphics[width=\paperwidth,height=\paperheight]{Background/Xilinx-Template-2019/section}
}}
\newcommand{\SubsectionBackground}{\setbeamertemplate{background canvas}{%
    %\includegraphics[width=\paperwidth,height=\paperheight]{Background/Xilinx_widescreen_size_16_9-091015-agenda_page}
    %\includegraphics[width=\paperwidth,height=\paperheight]{Background/Xilinx_widescreen_size_16_9-091015-normal_page}
    % \includegraphics[width=\paperwidth,height=\paperheight]{Background/Xilinx-Template-2018/agenda-item}
    \includegraphics[width=\paperwidth,height=\paperheight]{Background/Xilinx-Template-2019/section}
}}
\newcommand{\SubsubsectionBackground}{\SectionBackground}

% Color definitions see
% /usr/share/texlive/texmf-dist/tex/latex/beamer/beamercolorthemedefault.sty
%\setbeamercolor{structure}{fg=XilinxRed}
%\setbeamercolor{palette quaternary}{fg=XilinxRed}

\setbeamercolor{frametitle}{fg=XilinxRed,bg={}}
\setbeamercolor{framesubtitle}{fg=AMD-light-blue,bg=frametitle.bg}

\setbeamercolor{title}{fg=white}% Arial 40pt
\setbeamercolor{subtitle}{fg=white}
\setbeamercolor{author}{fg=white}% Arial 20pt
\setbeamercolor{institute}{fg=white}
\setbeamercolor{date}{fg=white}

\setbeamercolor{section in toc}{fg=XilinxRed}
\setbeamercolor{subsection in toc}{fg=XilinxRed}

% Try a black background for the slides:
%\setbeamertemplate{background canvas}[default]
%\setbeamercolor{background canvas}{bg=black}

\setbeamercolor{itemize item}{fg=XilinxRed}
\setbeamercolor{itemize subitem}{fg=XilinxRed}
\setbeamercolor{itemize subsubitem}{fg=XilinxRed}
%For some arrows like \vavers
\def\couleurfleche{\color{AMD-light-green}}


% For a smaller outline:
%\renewcommand{\OutlineFontSize}{\scriptsize}
%\renewcommand{\OutlineColumnNumbers}{2}
%\renewcommand\outlinename{Outline}


\mode<all>

\AtBeginDocument{
  \setbeamertemplate{itemize item}{{$\blacktriangleright$}}
  \setbeamertemplate{itemize subitem}{{$\smallblacksquare$}}
  \setbeamertemplate{itemize subsubitem}{{$\bullet$}}
}


\defbeamertemplate*{headline}{xilinx-2019}
{%
  %\pgfuseshading{beamer@treeshade}%
  %\vskip-10.25ex%
  \hbox{\begin{beamercolorbox}[wd=0.5\paperwidth,ht=3ex,ignorebg]
      {section in head/foot}
      \usebeamerfont{section in head/foot}%
      \ifx\insertsectionhead\@empty\else
        \hskip6pt\llap{\couleuritemr\donotcoloroutermaths$\bullet$}%
        \insertsectionhead
      \fi
      \end{beamercolorbox}
      \begin{beamercolorbox}[wd=0.5\paperwidth,ht=2.125ex,dp=1.125ex,ignorebg]
        {subsection in head/foot}
        \usebeamerfont{subsection in head/foot}%
        \ifx\insertsubsectionhead\@empty\else
          \hfill{\couleuritemt\donotcoloroutermaths$\blacktriangleright$}
          \insertsubsectionhead~~
      \fi
      \end{beamercolorbox}}
}

\defbeamertemplate*{footline}{xilinx-2019}
{%
  \hbox{%
    \begin{beamercolorbox}[wd=.2\paperwidth,ht=2.25ex,dp=1ex,left]{date in head/foot}%
      % \usebeamerfont{date in head/foot}\insertshortdate{}
      \hspace*{1em}
      \insertframenumber{} /
      \inserttotalframenumber
    \end{beamercolorbox}%
    \begin{beamercolorbox}[wd=.5\paperwidth,ht=2.25ex,dp=1ex,ignorebg,%
      rightskip=.3cm plus1fil]{title in head/foot}
      % This \if does not seem to work...
      \ifx\insertshorttitle\@empty\else
        \usebeamerfont{title in head/foot}%\hskip6pt\llap{%
          %\couleuritemc\donotcoloroutermaths$\blacksquare$}%
        \insertshorttitle
      \fi
    \end{beamercolorbox}%
    \begin{beamercolorbox}[wd=.2\paperwidth,ht=2.25ex,dp=1ex,left]
      {author in head/foot}%
      \ifx\insertshortinstitute\@empty\else
        \usebeamerfont{author in head/foot}\insertshortinstitute
      \fi
    \end{beamercolorbox}%
    \begin{beamercolorbox}[wd=.3\paperwidth,ht=2.25ex,dp=1ex,left]
      {title in head/foot}%
      \ifx\insertshortauthor\@empty\else
        \usebeamerfont{title in head/foot}\insertshortauthor
      \fi
    \end{beamercolorbox}%
  }%
  \vskip0pt%
}

% Corrected from
% /usr/share/texmf/tex/latex/beamer/themes/outer/beamerouterthemesmoothtree.sty
\defbeamertemplate*{frametitle}{xilinx-2019}
{%
  \usebeamerfont{headline}%
  \vskip-1ex%
  \begin{beamercolorbox}[wd=\paperwidth,leftskip=.935cm,rightskip=.3cm plus1fil]{frametitle}
    \usebeamerfont*{frametitle}\insertframetitle%
      \ifx\insertframesubtitle\@empty%
        \strut\par%
      \else
        \par{\usebeamerfont*{framesubtitle}{\usebeamercolor[fg]{framesubtitle}\insertframesubtitle}\strut\par}%
      \fi%%
    \usebeamerfont{headline}%
    \vskip.5ex
  \end{beamercolorbox}%
  \nointerlineskip
   \ifthenelse{\boolean{HeadLineSep}}{%
     \begin{beamercolorbox}[wd=\paperwidth,ht=.5ex,dp=0ex]{empty}
       \pgfuseshading{beamer@belowframetitle}%
     \end{beamercolorbox}%
   }%
   {}%
 }

% A background adapted from the official PowerPoint template
\setbeamertemplate{background canvas}{%
  %\includegraphics[width=\paperwidth,height=\paperheight]{Background/Xilinx_widescreen_size_16_9-091015-normal_page}
  \includegraphics[width=\paperwidth,height=\paperheight]{Background/Xilinx-Template-2019/content}
}

% \DealWithColors
% http://tex.stackexchange.com/questions/6185/absolute-positioning-in-beamer
% Many replies for the alternative forms of this question that use
% Tikz seem overcomplicated to me. If you look in the (long) Tikz
% manual, Section 17.13.2 has everything you need, in very simple
% terms. For example, for my case I used:
\setbeamertemplate{title page}
{
\begin{tikzpicture}[remember picture,overlay]
\node [xshift=-0.427\paperwidth, yshift=0.125\paperheight,
       anchor=west% Absolute left middle corner of the text to allow
                  % multi-line titles to remain vertically centered
                  % around this position
      ]
  at (current page.center)
{
  \begin{minipage}{0.8\linewidth}
      \begin{beamercolorbox}{title}
        \usebeamerfont{title}\inserttitle\par%
        \ifx\insertsubtitle\@empty%
        \else%
        \vskip0.25em%
        {\usebeamerfont{subtitle}\usebeamercolor[fg]{subtitle}\insertsubtitle\par}%
        \fi%
      \end{beamercolorbox}%
    \end{minipage}
};
\node [xshift=-0.427\paperwidth, yshift=-0.16\paperheight,
       anchor=north west% Absolute left top corner of the text
      ]
  at (current page.center)
{
  \begin{minipage}{0.8\linewidth}
      \begin{beamercolorbox}{author}
        \usebeamerfont{author}\insertauthor
      \end{beamercolorbox}

      \ifx\insertsubtitle\@empty%
      \else%
         \mbox{\begin{beamercolorbox}{institute}
           \usebeamerfont{institute}\insertinstitute
         \end{beamercolorbox}}
      \fi%

      \begin{beamercolorbox}{date}
        \usebeamerfont{date}\insertdate
      \end{beamercolorbox}\vskip0.5em
      {\usebeamercolor[fg]{titlegraphic}\inserttitlegraphic\par}
  \end{minipage}
};
\end{tikzpicture}
}
